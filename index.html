<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StationeryOS</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>

body{
margin:0;
background:#FDFCF0;
font-family:'Poppins',sans-serif;
color:#333;
}

header{
padding:24px;
text-align:center;
font-size:28px;
font-weight:700;
letter-spacing:1px;
}

.topbar{
display:flex;
justify-content:center;
margin-bottom:20px;
}

.primary-btn{
padding:12px 22px;
border:none;
border-radius:16px;
background:linear-gradient(135deg,#f6d365,#fda085);
color:#fff;
font-weight:600;
cursor:pointer;
transition:all .2s ease;
}

.primary-btn:hover{
transform:translateY(-2px);
box-shadow:0 8px 20px rgba(0,0,0,0.15);
}

.board{
display:flex;
gap:20px;
padding:20px;
justify-content:space-between;
}

.column{
background:#EAE7E1;
flex:1;
border-radius:16px;
padding:16px;
min-height:500px;
display:flex;
flex-direction:column;
}

.column-header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:12px;
font-weight:600;
}

.count{
background:#fff;
padding:4px 10px;
border-radius:12px;
font-size:12px;
}

.task{
background:#fff;
border-radius:16px;
padding:14px;
margin-bottom:12px;
box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);
cursor:grab;
transition:all .2s ease;
display:flex;
flex-direction:column;
gap:6px;
}

.task:hover{
transform:scale(1.02);
}

.task.dragging{
opacity:.4;
}

.task-title{
font-weight:600;
font-size:14px;
}

.task-meta{
font-size:12px;
opacity:.7;
}

.badge{
display:inline-block;
padding:3px 8px;
border-radius:10px;
font-size:11px;
color:#fff;
}

.low{background:#7ed6df;}
.medium{background:#f6b93b;}
.high{background:#eb4d4b;}

.task-actions{
display:flex;
justify-content:space-between;
margin-top:8px;
}

.icon-btn{
border:none;
padding:6px 10px;
border-radius:12px;
cursor:pointer;
font-size:12px;
transition:.2s;
background:linear-gradient(135deg,#a1c4fd,#c2e9fb);
}

.icon-btn:hover{
transform:translateY(-2px);
box-shadow:0 4px 10px rgba(0,0,0,.15);
}

.delete{
background:linear-gradient(135deg,#ff9a9e,#fecfef);
}

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,.3);
display:none;
align-items:center;
justify-content:center;
}

.modal-content{
background:#fff;
border-radius:16px;
padding:24px;
width:400px;
display:flex;
flex-direction:column;
gap:12px;
}

.modal-content input,
.modal-content textarea,
.modal-content select{
padding:10px;
border-radius:12px;
border:1px solid #ccc;
font-family:'Poppins';
}

.modal-content textarea{
resize:none;
height:80px;
}

.modal-footer{
display:flex;
justify-content:space-between;
margin-top:10px;
}

</style>
</head>
<body>

<header>StationeryOS</header>

<div class="topbar">
<button class="primary-btn" id="newTaskBtn">Novo Pedido</button>
</div>

<div class="board">

<div class="column" data-status="Recebido">
<div class="column-header">
<span>Recebido</span>
<span class="count">0</span>
</div>
</div>

<div class="column" data-status="Produção">
<div class="column-header">
<span>Produção</span>
<span class="count">0</span>
</div>
</div>

<div class="column" data-status="Acabamento">
<div class="column-header">
<span>Acabamento</span>
<span class="count">0</span>
</div>
</div>

<div class="column" data-status="Expedição">
<div class="column-header">
<span>Expedição</span>
<span class="count">0</span>
</div>
</div>

</div>

<div class="modal" id="taskModal">
<div class="modal-content">
<h3 id="modalTitle">Novo Pedido</h3>
<input type="text" id="taskName" placeholder="Nome do Cliente">
<input type="email" id="taskEmail" placeholder="Email do Cliente">
<textarea id="taskDesc" placeholder="Descrição do Pedido"></textarea>
<select id="taskPriority">
<option value="low">Baixa</option>
<option value="medium">Média</option>
<option value="high">Alta</option>
</select>
<div class="modal-footer">
<button class="icon-btn" id="cancelBtn">Cancelar</button>
<button class="primary-btn" id="saveTaskBtn">Salvar</button>
</div>
</div>
</div>

<script>

let tasks = JSON.parse(localStorage.getItem("stationeryOS_v2")) || [];
let editingId = null;

function saveStorage(){
localStorage.setItem("stationeryOS_v2",JSON.stringify(tasks));
}

function openModal(editTask=null){
document.getElementById("taskModal").style.display="flex";
if(editTask){
editingId=editTask.id;
document.getElementById("modalTitle").innerText="Editar Pedido";
document.getElementById("taskName").value=editTask.name;
document.getElementById("taskEmail").value=editTask.email;
document.getElementById("taskDesc").value=editTask.description;
document.getElementById("taskPriority").value=editTask.priority;
}else{
editingId=null;
document.getElementById("modalTitle").innerText="Novo Pedido";
document.getElementById("taskName").value="";
document.getElementById("taskEmail").value="";
document.getElementById("taskDesc").value="";
document.getElementById("taskPriority").value="low";
}
}

function closeModal(){
document.getElementById("taskModal").style.display="none";
}

function render(){
document.querySelectorAll(".column").forEach(col=>{
col.querySelectorAll(".task").forEach(t=>t.remove());
});

tasks.forEach(task=>{
const col=document.querySelector(`.column[data-status="${task.status}"]`);
const div=document.createElement("div");
div.className="task";
div.draggable=true;
div.dataset.id=task.id;

const title=document.createElement("div");
title.className="task-title";
title.innerText=task.name;

const meta=document.createElement("div");
meta.className="task-meta";
meta.innerText=task.description;

const badge=document.createElement("span");
badge.className="badge "+task.priority;
badge.innerText=task.priority.toUpperCase();

const actions=document.createElement("div");
actions.className="task-actions";

const notify=document.createElement("button");
notify.className="icon-btn";
notify.innerText="✉";
notify.onclick=function(){
let subject=encodeURIComponent("Seu pedido "+task.name+" atualizou!");
let body=encodeURIComponent("Olá "+task.name+",%0D%0A%0D%0AO seu pedido está em: "+task.status+"%0D%0APrioridade: "+task.priority+"%0D%0A%0D%0AEquipe StationeryOS");
window.location.href="mailto:"+task.email+"?subject="+subject+"&body="+body;
};

const edit=document.createElement("button");
edit.className="icon-btn";
edit.innerText="Editar";
edit.onclick=function(){openModal(task);};

const del=document.createElement("button");
del.className="icon-btn delete";
del.innerText="Excluir";
del.onclick=function(){
if(confirm("Deseja excluir este pedido?")){
tasks=tasks.filter(t=>t.id!==task.id);
saveStorage();
render();
}
};

actions.appendChild(notify);
actions.appendChild(edit);
actions.appendChild(del);

div.appendChild(title);
div.appendChild(meta);
div.appendChild(badge);
div.appendChild(actions);

div.addEventListener("dragstart",function(){
div.classList.add("dragging");
});

div.addEventListener("dragend",function(){
div.classList.remove("dragging");
});

col.appendChild(div);
});

document.querySelectorAll(".column").forEach(col=>{
let count=col.querySelectorAll(".task").length;
col.querySelector(".count").innerText=count;
});
}

document.getElementById("newTaskBtn").onclick=function(){
openModal();
};

document.getElementById("cancelBtn").onclick=function(){
closeModal();
};

document.getElementById("saveTaskBtn").onclick=function(){
let name=document.getElementById("taskName").value.trim();
let email=document.getElementById("taskEmail").value.trim();
let desc=document.getElementById("taskDesc").value.trim();
let priority=document.getElementById("taskPriority").value;

if(name===""||email===""){
alert("Nome e Email são obrigatórios");
return;
}

if(editingId){
let task=tasks.find(t=>t.id===editingId);
task.name=name;
task.email=email;
task.description=desc;
task.priority=priority;
}else{
tasks.push({
id:Date.now(),
name:name,
email:email,
description:desc,
priority:priority,
status:"Recebido",
createdAt:new Date().toISOString()
});
}

saveStorage();
closeModal();
render();
};

document.querySelectorAll(".column").forEach(column=>{
column.addEventListener("dragover",function(e){
e.preventDefault();
const dragging=document.querySelector(".dragging");
if(dragging){
column.appendChild(dragging);
}
});
column.addEventListener("drop",function(){
const dragging=document.querySelector(".dragging");
if(dragging){
let id=Number(dragging.dataset.id);
let task=tasks.find(t=>t.id===id);
task.status=column.dataset.status;
saveStorage();
render();
}
});
});

render();

</script>

</body>
</html>
